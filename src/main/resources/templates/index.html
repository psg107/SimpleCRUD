<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <!--bootstrap-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

    <script>
        /**
         * 상세보기
         * @param e
         */
        function showDrink(e){
            var id = e.value;
            location.href = `/Detail/${id}`;
        }

        /**
         * 삭제하기
         * @param e
         */
        function deleteDrink(e){
            var confirmDelete = confirm('삭제하시겠습니까?');
            if (confirmDelete == false) {
                return;
            }

            var id = e.value;

            fetch(`/Delete/${id}`, {
                method: 'DELETE'
            })
            .then(response => {
                if (response.status != 200){
                    alert('삭제 오류 발생');
                }

                location.reload();
            });
        }

        /**
         * 클라이언트 사이드 음료 입력 검증
         */
        function validateDrink() {
            var name = document.querySelector('.js-name').value
            var price = document.querySelector('.js-price').value;

            if (price == '' || Number(price) == NaN){
                alert('금액이 잘못되었습니다.');
                return false;
            }

            return true;
        }
    </script>
</head>
<body>
<div class="container">
    <!--READ-->
    <div class="row mt-5">
        <div class="col">
            <h1>조회</h1>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <table class="table">
                <thead>
                    <tr>
                        <th scope="col" style="width:20%">음료ID</th>
                        <th scope="col" style="width:20%">음료명</th>
                        <th scope="col" style="width:20%">가격</th>
                        <th scope="col" style="width:20%">등록직원</th>
                        <th scope="col" style="width:20%">*</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="drink : ${drinks}">
                        <td class="align-middle" th:text="${drink.drinkId}"></td>
                        <td class="align-middle" th:text="${drink.name}"></td>
                        <td class="align-middle" th:text="${drink.price}"></td>
                        <td class="align-middle" th:text="${drink.regEmployeeName}"></td>
                        <td class="align-middle">
                            <button th:value="${drink.drinkId}" class="btn btn-primary" onclick="showDrink(this)">상세보기</button>
                            <button th:value="${drink.drinkId}" class="btn btn-warning" onclick="deleteDrink(this)">삭제하기</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!--CREATE-->
    <div class="row mt-5">
        <div class="col">
            <h1>추가</h1>
        </div>
    </div>
    <div class="row">
        <form action="/Insert" method="post" onsubmit="return validateDrink()">
            <!--이름-->
            <div class="mb-3">
                <label for="name" class="form-label">이름</label>
                <input type="text" class="form-control js-name" id="name" name="name" placeholder="">
            </div>

            <!--금액-->
            <div class="mb-3">
                <label for="price" class="form-label">금액</label>
                <input type="number" class="form-control js-price" id="price" name="price"></input>
            </div>

            <!--버튼-->
            <div class="mb-3">
                <input type="submit" class="btn btn-primary" value="등록">
            </div>
        </form>
    </div>
</div>
</body>
</html>